function FloaterWidget(e){this.addPlaylistContent=!1,this.setupParameters={inRead:"content"==e.floater_method?!1:"floater"},this.ad_id=e.ad_id,this.isIframe=e.is_iframe,this.callbacks=e.callbacks,this.containerId="br_video_player_"+this.ad_id,this.placementId=e.br_id.replace(/^#/,""),this.floater_method=e.floater_method,this.secondsToSkip=parseInt(e.seconds_to_allow_ad_skip||10),this.mobileEnvironment=e.mobile_environment,this.floater_position=e.floater_position||"bottom-right",e.floater_adv_logo&&(this.floaterAdv={bgColor:e.floater_adv_bg_color,link:e.floater_adv_link,logo:e.floater_adv_logo,pos:e.floater_adv_position,hide:void 0===this.floater_method||"ads"==this.floater_method});var t="";switch(this.floater_position){case"top-left":t="left: 0px !important; top: 0px !important;";break;case"top-right":t="right: 0px !important; top: 0px !important;";break;case"bottom-left":t="left: 0px !important; bottom: 0px !important;";break;case"bottom-right":default:t="right: 0px !important; bottom: 0px !important;"}var i=window.br_util;if(!e.lkqd_tag)if(this.isIframe)document.getElementById(this.placementId).style.cssText="-webkit-transition: height 2s linear; -moz-transition: height 2s linear; -o-transition: height 2s linear; -ms-transition: height 2s linear; transition: height 2s linear;";else{var o=document.getElementById(this.containerId).parentNode;o.style.cssText="position: fixed !important; z-index: 2147483647 !important; height: "+(void 0===this.floater_method||"ads"==this.floater_method?0:e.height)+"px; -webkit-transition: height 2s linear; -moz-transition: height 2s linear; -o-transition: height 2s linear; -ms-transition: height 2s linear; transition: height 2s linear; "+t+(i.isMobile()&&"ios"==e.mobileMacros.os?"display: none;":""),document.getElementById(this.containerId).style.cssText="-webkit-transition: height 2s linear; -moz-transition: height 2s linear; -o-transition: height 2s linear; -ms-transition: height 2s linear; transition: height 2s linear;";var n=document.createElement("div");n.style.cssText="position: relative; visibility: visible; height: 0px; width: "+this.width+"px; background-color: rgb(00, 00, 00);text-align:left;";var s=document.createElement("div");s.id="skip-ad",s.style.cssText="position: relative; visibility: visible; display: inline; height: 15px; font-family: verdana; color: rgb(255, 255, 255); font-weight: bold; font-size: 9px; text-decoration: none; cursor: pointer; overflow: hidden; background-color: rgb(00, 00, 00);vertical-align: top;line-height:15px; margin-left: 4px;",s.textContent="content"==this.floater_method?"Close":"",s.onclick=function(){if("Close"==s.textContent){var e=document.getElementById(this.containerId).parentNode;e.parentNode.removeChild(e)}}.bind(this),n.appendChild(s),o.insertBefore(n,o.childNodes[0]),this.SetFloaterAdvertisement(),setTimeout(function(){this.floaterAdv&&!this.floaterAdv.hide&&this.ShowFloaterAdvertisement(e.height,e.width)}.bind(this),100)}Widget.call(this,e)}FloaterWidget.prototype=Object.create(Widget.prototype),FloaterWidget.prototype.constructor=Widget,FloaterWidget.prototype.renderWidget=function(){this.loadVideoPlayer()},FloaterWidget.prototype.onVideoPlayerReady=function(){if(!this.shown){var e=document.getElementById(this.playerId);this.renderVideoPlayer(e)}},FloaterWidget.prototype.onRenderPlayer=function(){var e=window.br_util;this.playerObj.onAdEnd(function(){if(this.isIframe)this.SendMessageToParent("adEnded");else{if(e.isMobile()&&"mobile"==this.mobileEnvironment){var t=document.getElementById(this.containerId);t&&(t=t.parentNode,t.parentNode.removeChild(t))}else{var i=document.getElementById("skip-ad");i.textContent="Close",this.skipInterval=clearTimeout(this.skipInterval),i.onclick=function(){if("Skip ad"!=i.textContent||window.br_util.isMobile()&&"tablet"!=this.mobileEnvironment){var e=document.getElementById(this.containerId).parentNode;e.parentNode.removeChild(e)}else this.playerObj.skip()}.bind(this)}e.doWidgetCallback.call(this,"ad_complete")}}.bind(this)),this.playerObj.onAdLoaded(function(t){this.duration=t,this.isIframe?this.SendMessageToParent("adLoaded",this.duration):(this.ShowFloater(),e.doWidgetCallback.call(this,"ad_start"))}.bind(this)),this.playerObj.onAdStarted(function(t){this.duration=t,this.isIframe?this.SendMessageToParent("adStarted",this.duration):(this.SetSkipAd(),e.doWidgetCallback.call(this,"ad_start"))}.bind(this)),this.playerObj.onLoopEnds(function(){if(this.isIframe)this.SendMessageToParent("loopEnds");else{var e=document.getElementById(this.containerId).parentNode;e.parentNode.removeChild(e)}}.bind(this)),this.passback&&this.playerObj.onPassbackSwitch(function(){this.stop=!0,this.onPassbackCallback&&this.onPassbackCallback()}.bind(this))},FloaterWidget.prototype.SendMessageToParent=function(e,t){window.br_util.sendMessage(parent,this.ad_id,"FloaterWidget",e,t)},FloaterWidget.prototype.StartAd=function(){(void 0===this.floater_method||"ads"==this.floater_method)&&(this.playerObj.startInRead(),this.widgetFq&&window.br_util.setWidgetFqCookie(this.publisher_id,this.widget_id))},FloaterWidget.prototype.ListenToMessagesFromParent=function(){window.addEventListener("message",function(e){var t=window.br_util.receiveMessage(e.data);if(t&&t.ad_id==this.ad_id&&"FloaterLoader"==t.source)switch(t.message){case"startAd":this.StartAd();break;case"skipAd":this.playerObj.skip();break;case"inflatePlayer":this.playerObj.inflatePlayer()}}.bind(this),!1)},FloaterWidget.prototype.ShowFloater=function(){if(!this.shown&&!this.stop){var e=window.br_util,t=document.getElementById(this.containerId).parentNode;this.shown=!0,t.style.display="block",t.style.height=this.height+15+"px",t.style.width=this.width+"px",document.getElementById(this.containerId).style.height=this.height+"px",document.getElementById("skip-ad").parentNode.style.height="15px",this.floaterAdv&&this.floaterAdv.hide&&this.ShowFloaterAdvertisement(),window.br_util.viewabilityTest.call(this),this.SetSkipAd();var i=e.tryGetGoogleIframe();if(i){for(var o in t.style)i.style[o]=t.style[o];i.style.border="none"}this.stop||this.StartAd()}},FloaterWidget.prototype.SetSkipAd=function(){if(!this.skipInterval){var e=this.duration<this.secondsToSkip?window.br_util.defaults.minimum_seconds_to_skip:this.secondsToSkip,t=document.getElementById("skip-ad");t.onclick=function(){},t.textContent="Skip ad"+(e>0?" in "+e+" seconds":""),function i(){this.skipInterval=clearTimeout(this.skipInterval),this.skipInterval=setTimeout(function(){--e>0?(t.textContent="Skip ad in "+e+" seconds",i.call(this)):(t.textContent="Skip ad",t.onclick=function(){if("Skip ad"!=t.textContent||window.br_util.isMobile()&&"tablet"!=this.mobileEnvironment){var e=document.getElementById(this.containerId).parentNode;e.parentNode.removeChild(e)}else this.playerObj.skip()}.bind(this))}.bind(this),1e3)}.bind(this)()}},FloaterWidget.prototype.showContentFloater=function(){this.isIframe&&"content"==this.floater_method&&this.SendMessageToParent("contentFloater")},FloaterWidget.prototype.SetFloaterAdvertisement=function(){if(this.floaterAdv){var e=document.createElement("div"),t=document.createElement("img");"top"==this.floaterAdv.pos?(e.style.cssText="position: relative;",document.getElementById(this.containerId).parentNode.insertBefore(e,document.getElementById("skip-ad").parentNode.nextSibling)):(e.style.cssText="position: fixed;",document.getElementById(this.containerId).parentNode.appendChild(e)),e.style.cssText+="width: 0px; height: 0px; "+(this.floater_position.indexOf("bottom")>-1?"bottom":"top")+": 0px; background-color: #"+this.floaterAdv.bgColor+"; cursor: pointer; transition: height 2s linear; -webkit-transition: height 2s linear; -moz-transition: height 2s linear; -o-transition: height 2s linear; -ms-transition: height 2s linear;",e.className="floater-advertisement",t.style.cssText="width: 0px; height: 0px; transition: height 2s linear; -webkit-transition: height 2s linear; -moz-transition: height 2s linear; -o-transition: height 2s linear; -ms-transition: height 2s linear;",this.floaterAdv.link&&e.addEventListener("click",function(){window.open(this.floaterAdv.link,"_blank")}.bind(this)),t.src=this.floaterAdv.logo,e.appendChild(t)}},FloaterWidget.prototype.ShowFloaterAdvertisement=function(e,t){var i=document.getElementsByClassName("floater-advertisement")[0];switch(i.firstChild.style.padding="10px",i.firstChild.style.width="20px",i.firstChild.style.height="22px",this.floaterAdv.pos){case"left":i.style.width="40px",i.style.height=(this.height||e)+15+"px",this.floater_position.indexOf("right")>-1?i.style.right=(this.width||t)+"px":(i.style.left="0px",document.getElementById(this.containerId).style.left="40px",document.getElementById("skip-ad").parentNode.style.left="40px");break;case"right":i.style.width="40px",i.style.height=(this.height||e)+15+"px",this.floater_position.indexOf("right")>-1?(i.style.right="0px",document.getElementById(this.containerId).style.right="40px",document.getElementById("skip-ad").parentNode.style.right="40px"):i.style.left=(this.width||t)+"px";break;case"top":document.getElementById(this.containerId).parentNode.style.height=this.height+40+15+"px",i.style.width=(this.width||t)+"px",i.style.height="40px";break;case"bottom":i.style.width=(this.width||t)+"px",i.style.height="40px",this.floater_position.indexOf("bottom")>-1?(document.getElementById(this.containerId).style.bottom="40px",document.getElementById("skip-ad").parentNode.style.bottom="40px"):i.style.top=(this.height||e)+15+"px"}},FloaterWidget.prototype.SetOnPassbackCallback=function(e){this.onPassbackCallback=e};